import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.util.ArrayList;

import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class TemplatesWithTabs extends JTabbedPane
// implements ItemListener
{
  private ArrayList<SingleTemplatePanelWDesigner> templatePanes = new ArrayList<SingleTemplatePanelWDesigner>();
  private TeacherReportAssistant tra;

  /*
  public TabbedTemplatePanesX()
  {
    super();
  }
  */

  public TemplatesWithTabs(TeacherReportAssistant tra)
  {
    ArrayList<TemplateCategory> templates = tra.getTemplateCategories();
    this.tra = tra;

    //for (int i=templates.size()-1; i>=0; i--)
    for (TemplateCategory tc: templates)
    {
      //TemplateCategory tc = templates.get(i);
      JPanel p = new JPanel();
      
      GridBagLayout layout = new GridBagLayout();
      p.setLayout(layout);
      
      GridBagConstraints gbc = new GridBagConstraints();
      
      gbc.gridx=0;
      gbc.gridy=0;
      gbc.weightx=1.0;
      gbc.weighty=1.0;
      gbc.anchor = GridBagConstraints.NORTHWEST;

      // Create panel to contain template check boxes
      SingleTemplatePanelWDesigner tp = new SingleTemplatePanelWDesigner(tra,tc);
      templatePanes.add(tp);
      

      p.add(tp,gbc);
      
      this.add(tc.getName(), p);
    }
    
    // Call apply() when tab is changed;
    ChangeListener changeListner = new ChangeListener() {
      public void stateChanged(ChangeEvent changeEvent) {
        apply();
      }
    };
    this.addChangeListener(changeListner);
  }

  public void uncheckBoxes()
  {
    for (SingleTemplatePanelWDesigner tp : templatePanes)
      for (TemplateCheckBox tcb : tp.getTemplateCheckBoxesInPanel())
        tcb.setSelected(false);
  }
  
  public void setFocusToFirstTab()
  {
    this.setSelectedIndex(0);
  }
  
  
  public String apply()
  {
    // Get text associated with checked boxes
    String retVal="";
    for (SingleTemplatePanelWDesigner tp : templatePanes)
    {
      String paneText=tp.apply();
       retVal+=paneText;
    }
   
    uncheckBoxes();
    return retVal;
  }
}



